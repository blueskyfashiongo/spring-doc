### chatper 12. 모범 사례

### 아키텍처 결정 레코드 (Architecture Decision Record) - ADR

- 의사결정 프로세스에서 사용될 수 있는 아키텍처 의사결정 및 근거의 기록
- 필요한 이유
  - 프로덕트 초기 단계에서 내려진 결정을 이후에 변경한다고 생각해보자. 해당 결정이 왜 그리고 어떻게 내려졌는지에 대한 지식 없이 이 결정을 변경하는 것은 위험하다. 어떤 기술이 한 개 또는 그 이상의 요구사항을 맞추기 위해 선택되었을 수 있다.
- 어떤 결정에 ADR이 필요할까?
  - ```
    - 개발자들이 소프트웨어를 작성하는 데 영향을 미치는 결정
    - 변경하기 어렵거나 비용이 많이 들기 때문에 최선의 선택지를 선택하는 것이 중요한 결정
    - 논의 초반에 충분히 좋은 근거가 있었음을 계속해서 파악하느라 시간이 낭비되는 결정
    - 프로젝트 온보딩 과정 중에 계속 질문이 들어오는 결정
    - 다른팀에서 내린 결정을 도입하는 경우
    - 장기적으로 다수의 컴포넌트나 시스템에 영향을 미치는 결정
    - 복잡하거나 이해하기 어려운 결정
    - ...
    ```
    
#### ADR 구조
```
### 식별자와 제목 - 내려진 결정에 대한 지술

###상태
초안 / 결정 / ADR-XXX에 의해 대체됨

### 맥락
결정을 내려야 하는 이유. 가정, 제안, 결정 추진 동인

### 평가 기준
이 결정을 내리는 데 있어서 중요한 것은 무엇인가?
이 결정을 내리는 데 있어서 어떤 아키텍처 특성이 적용되는가?
기준이 되는 제약 사항이나 결정의 추진 동인이 있는가?
(기업 고려사항, 제약 사항, 보안 사항, 요구 사항 등)

### 선택지
평가 기준(점수나 등급)에 따라 고려된 선택지들의 개요, 또한 평가 기준 외의 트레이드 오프

### 결정
내려진 결정과 그 이유.

### 예상 결과
내려진 결정의 긍정/부정적인 결과
```

- 상태
  - ![image](https://github.com/user-attachments/assets/cee22ef1-1889-4414-9719-f4d30709ce45)
  - ![image](https://github.com/user-attachments/assets/2086c8b2-10dd-45c5-aaff-14a1be3a712e)

- 예시
  - ![image](https://github.com/user-attachments/assets/e280b902-ff54-4ef1-a90f-4d91d70939e0)
  - ![image](https://github.com/user-attachments/assets/0934f175-d1b5-48be-8275-b3c5d1bc1298)
 
#### ADR 문화
- 다른 사람의 질문에 대한 답을 찾기 위해 작성한 ADR을 보도록 안내할 수 있다.
- 변경에 대한 토론이 시작되면 원래 결정에 대한 ADR을 제시하며 논의를 지원할 수 있다.
- 문화를 만들어보자
  - 주간 검토 회의에 의사결정에 대한 논의를 추가하여 필요한 경우 의사결정에 대한 ADR을 작성할 수 있도록 한다
  - 프로덕트와 관련된 ADR 검토를 온보딩 프로세스의 일부로 포함시켜 새로운 팀원들이 빠르게 업무에 적응할 수 있도록 한다
  - 누군가 기존 ADR로 답변할 수 없는 질문을 했을 때 새로 ADR을 작성하자

### 아키텍처 특성
- 아키텍처 특성을 도출하면 이해관계자의 우선순위를 충족하는 아키텍처를 설계할 수 있다.
  - ```
    - 접근성
    - 가용성
    - 구성 가능성
    - 연속성
    - 확장성
    - 이식성
    - 프라이버시
    - 확장성
    - 실현 가능성
    - 보안
    - 단순성
    ```
- 프로덕트 주기에 따라 아키텍처 특성을 사용하고 재검토하자
  - ![image](https://github.com/user-attachments/assets/05cd658d-0fe4-416e-af7c-c5f2f09b0503)
- 효과적인 아키텍처 특성 기록 방법
  - 해당 특성이 시스템의 어느 영역에 적용되는지 표시
  - 아키텍처 특성의 출처를 기록
  - 각 특성에 아이덴티티를 부여
  - 고려된 모든 특성을 기재
  - 날짜를 사용해 이력을 기록
  - 우선순위 3개를 파악
  - 예시
  - | ID   | 특성            | 적용 가능                                    | 출처                                                             |
    | --- | --- | --- | --- |
    | AC01 | 감사 가능성 | 미디어 서비스                              | REQ 014 시스템 분석을 위해 모든 미디어 접근과 사용을 기록해야 한다. |
    | AC02 | 결함 내성   | 결제 인터페이스, 외부 미디어 인터페이스, 고객 API, 고객 UI | REQ 025 & REQ 026                                                |
    | AC03 | 확장 가능성 | 외부 미디어 인터페이스                     | REQ 029 시스템에 외부 미디어 소스를 쉽게 추가할 수 있어야 한다     |


### 모든 문서를 코드처럼 (Document as code)
- 기술 문서
  - 문서 소스 파일은 버전 관리 시스템(예: 깃)에 저장
  - 신뢰할 수 있는 검토자(예: 개발자 및 테크니컬 라이터)가 문서를 검토
  - 문서는 검토자에 의해, 테스트를 통해 자동으로 검증
  - 문서 아티팩트는 자동으로 작성 (예: 문서의 HTML 버전)
  - 아티팩트는 많은 개입 없이 게시된다
- 자동 생성 문서
- 기타 문서
  - 비개발자들을 억지로 개발의 세계로 끌어들이지 않으면서 원칙을 적용해야 한다
- 추천 오픈 소스
  - Docusaurus: 마크다운 파일로 문서 사이트를 생성
  - MkDocs: 프로젝트 문서를 작성
  - Docsify: 마트다운 파일에서 문서 웹사이트를 즉시 생성
  - 백스테이지: 개발자 포털을 구축하며 원래 스포티파이에서 개발
  - docToolchain: 강력한 기술 문서를 쉽게 작성하고 유지 관리할 수 있는 스크립트 모음
  - Doxygen: 다양한 인기 코딩 언어로 문서를 생성
  - Swagger: API 개발 및 문서화를 위한 오픈 소스 도구 세트
  - docfx: .Net 어셈블리, XML 코드 주석, REST API Swagger 파일 및 Markdown을 HTML, JSON 또는 PDF 파일로 변환

